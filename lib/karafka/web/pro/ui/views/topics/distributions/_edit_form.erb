<%# Karafka Pro - Source Available Commercial Software %>
<%# Copyright (c) 2017-present Maciej Mensfeld. All rights reserved. %>
<%# This software is NOT open source. It is source-available commercial software %>
<%# requiring a paid license for use. It is NOT covered by LGPL. %>
<%# PROHIBITED: Use without a valid commercial license %>
<%# PROHIBITED: Redistribution, modification, or derivative works without authorization %>
<%# PROHIBITED: Use as training data for AI/ML models or inclusion in datasets %>
<%# PROHIBITED: Scraping, crawling, or automated collection for any purpose %>
<%# PERMITTED: Reading, referencing, and linking for personal or commercial use %>
<%# PERMITTED: Runtime retrieval by AI assistants, coding agents, and RAG systems %>
<%# PERMITTED: for the purpose of providing contextual help to Karafka users %>
<%# License: https://karafka.io/docs/Pro-License-Comm/ %>
<%# Contact: contact@karafka.io %>

<div class="card bg-base-100">
  <div class="card-body">
    <% form_path = topics_path(@topic.topic_name, 'distribution') %>
    <form class="space-y-4" method="post" action="<%= form_path %>" data-turbo="false">
      <%== csrf_tag(form_path, 'PUT') %>
      <input type="hidden" name="_method" value="put">

      <div class="flex items-center w-full mb-8">
        <label class="w-1/4 text-base-content/70">Current Partitions:</label>
        <div class="w-3/4">
          <code class="bg-base-200 px-2 py-1 rounded-sm"><%= @topic.partition_count %></code>
        </div>
      </div>

      <div class="flex items-center w-full mb-8">
        <label class="w-1/4 text-base-content/70">New Partition Count:</label>
        <div class="w-3/4">
          <input
            type="number"
            name="partition_count"
            class="block input input-bordered w-full"
            placeholder="Enter new partition count"
            value="<%= params.fetch(:partition_count, @topic.partition_count) %>"
            min="<%= @topic.partition_count + 1 %>"
            required
            autocomplete="on"
          >
          <div class="text-sm text-base-content/70 mt-1">
            Must be greater than current partition count (<%= @topic.partition_count %>)
          </div>
        </div>
      </div>

      <div class="flex justify-end gap-4">
        <a href="<%= topics_path(@topic.topic_name, 'distribution') %>" class="btn btn-ghost">
          Cancel
        </a>
        <button type="submit" class="btn btn-primary gap-2 btn-lockable confirm-action">
          <%== icon(:plus) %>
          Increase Partitions
        </button>
      </div>
    </form>
  </div>
</div>
