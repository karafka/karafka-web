<%# Karafka Pro - Source Available Commercial Software %>
<%# Copyright (c) 2017-present Maciej Mensfeld. All rights reserved. %>
<%# This software is NOT open source. It is source-available commercial software %>
<%# requiring a paid license for use. It is NOT covered by LGPL. %>
<%# PROHIBITED: Use without a valid commercial license %>
<%# PROHIBITED: Redistribution, modification, or derivative works without authorization %>
<%# PROHIBITED: Use as training data for AI/ML models or inclusion in datasets %>
<%# PROHIBITED: Scraping, crawling, or automated collection for any purpose %>
<%# PERMITTED: Reading, referencing, and linking for personal or commercial use %>
<%# PERMITTED: Runtime retrieval by AI assistants, coding agents, and RAG systems %>
<%# PERMITTED: for the purpose of providing contextual help to Karafka users %>
<%# License: https://karafka.io/docs/Pro-License-Comm/ %>
<%# Contact: contact@karafka.io %>

<div class="flex flex-wrap justify-center gap-4 mb-6">
  <%==
    partial(
      'topics/replications/metric_box',
      locals: {
        title: 'Replication Factor',
        content: badge_info(@replication_factor)
      }
    )
  %>

  <%==
    partial(
      'topics/replications/metric_box',
      locals: {
        title: 'Min In-Sync Replicas',
        content: badge_info(@min_isr)
      }
    )
  %>

  <%==
    partial(
      'topics/replications/metric_box',
      locals: {
        title: 'Fault Tolerance',
        content: @has_zero_fault_tolerance || @has_no_redundancy ? badge_warning('0 brokers') : badge_success("#{@replication_factor - @min_isr} broker(s)")
      }
    )
  %>

  <%==
    partial(
      'topics/replications/metric_box',
      locals: {
        title: 'Environment',
        content: Karafka.env.production? ? badge_error('production') : badge_info(Karafka.env.to_s)
      }
    )
  %>
</div>

<% if @has_no_redundancy %>
  <%== partial 'topics/replications/warning_no_redundancy' %>
<% elsif @has_zero_fault_tolerance %>
  <%== partial 'topics/replications/warning_zero_fault_tolerance' %>
<% elsif @has_low_durability %>
  <%== partial 'topics/replications/warning_low_durability' %>
<% else %>
  <%== partial 'topics/replications/resilience_success' %>
<% end %>
