<%# This code is part of Karafka Pro, a commercial component not licensed under LGPL. %>
<%# See LICENSE for details. %>

<%
  partitions = @topic_stats[:partitions]
  total_partitions = @topic_stats[:partitions_count]
  assigned_partitions = partitions.size

  active_count = partitions.values.count { |p| p.poll_state == 'active' }
  paused_count = partitions.values.count { |p| p.poll_state != 'active' }

  # Get unique process count
  process_count = partitions.values.map { |p| p[:process].id }.uniq.size
%>

<div class="card bg-base-100 mt-4">
  <div class="card-body">
    <h3 class="card-title text-lg">Topic Information</h3>

    <div class="grid grid-cols-2 gap-4 mt-2">
      <div>
        <span class="text-base-content/70">Topic:</span>
        <span class="font-mono"><%= @topic %></span>
      </div>
      <div>
        <span class="text-base-content/70">Consumer Group:</span>
        <span class="font-mono"><%= @consumer_group_id %></span>
      </div>
      <div>
        <span class="text-base-content/70">Total Partitions (cluster):</span>
        <span class="font-mono"><%= total_partitions %></span>
      </div>
      <div>
        <span class="text-base-content/70">Assigned Partitions:</span>
        <span class="font-mono"><%= assigned_partitions %></span>
      </div>
      <div>
        <span class="text-base-content/70">Active Processes:</span>
        <span class="font-mono"><%= process_count %></span>
      </div>
    </div>

    <div class="mt-4">
      <span class="text-base-content/70">Partition States (across all processes):</span>
      <span class="badge badge-success badge-sm ml-2"><%= active_count %> active</span>
      <span class="badge badge-warning badge-sm ml-2"><%= paused_count %> paused</span>
    </div>
  </div>
</div>
